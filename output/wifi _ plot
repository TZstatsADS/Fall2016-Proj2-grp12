library(dplyr)
library(ggmap)
library(ggplot2)
library(DT)
library(readr)
library(data.table)
library(qmap)
setwd("/Users/zuonianyao/Documents/GR5243/Project2")
wifi <- fread("NYC_Wi-Fi_Hotspot_Locations_Map.csv")
wifi_1 <- wifi %>% 
       dplyr::select(Type,Location,Lat,Long_,Location_T,City) %>%
       filter(Type=="Free"|Type=="Limited Free")
nycMap <- qmap("new york city", zoom = 10, legend = "topleft")
nyc_scatter <- nycMap + 
               geom_point(aes(x = Long_, y = Lat, colour = "blue",alpha=0.3), data = wifi_1)+ 
               ggtitle("The scatter plot of free wifi in NYC") +        
               theme(axis.text=element_blank(),axis.ticks=element_blank(),
               axis.title=element_blank())
nyc_scatter
nyc <- get_map("new york city", zoom = 11)
nyc_heat <-  ggmap(nyc, extent = "device") + geom_density2d(data =wifi_1, aes(x = Long_, y = Lat), 
             size = 0.5) + stat_density2d(data = wifi_1, aes(x = Long_, y = Lat, 
             fill = ..level.., alpha = ..level..), size = 0.05, bins = 20, geom = "polygon") + 
             scale_fill_gradient(low = "yellow", high = "purple") + 
             scale_alpha(range = c(0, 0.5), guide = FALSE)+ 
             ggtitle("The heatmap of free wifi in NYC")
nyc_heat
